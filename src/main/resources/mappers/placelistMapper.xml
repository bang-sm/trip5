<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mappers.placelistMapper">

	<insert id="placeinsert" parameterType="com.sm.domain.PlacelistVo">
		INSERT INTO 
		placeList(
				placeid,
				placename,
				placeregdate,
				placecheck,
				placejuso,
				uuid,
				placecategory,
				bookmark,
				bloglink,
				iconname)
		VALUES(
				placeid,
				#{placename},
				now(),
				0,
				#{placejuso},
				#{uuid},
				#{placecategory},
				0,
				#{bloglink},
				#{iconname}
				);
	</insert>
	<select id="placeshow" parameterType="int" resultType="com.sm.domain.PlacelistVo">
		SELECT
			placeid,
			placename,
			placecategory,
			iconname,
			placejuso,
			placeregdate,
			bookmark,
			placecheck,
			bloglink
		FROM
		    placeList
		WHERE
			uuid =#{uuid}
		ORDER BY
		    bookmark DESC;
	</select>
	<update id="bookmark" parameterType="map">
		UPDATE	 
			placeList 
		SET 
			bookmark =#{bookmark} 
		WHERE 
			placeid= #{placeid};
	</update>
	
	<update id="checkbox" parameterType="map">
		UPDATE	 
			placeList 
		SET 
			placecheck =#{placecheck} 
		WHERE 
			placeid= #{placeid};
	</update>
	
	<select id="goplace" parameterType="map" resultType="com.sm.domain.PlacelistVo">
		SELECT
			*
		FROM
			placeList
		WHERE
			placecheck=#{placecheck} and uuid =#{uuid};
	</select>
	
	<select id="barchart" parameterType="map" resultType="int">
		SELECT
			count(placeid)
		FROM
			placeList
		WHERE  
			placecategory = #{placecategory} and placecheck =#{placecheck} and uuid=#{uuid};
	
	</select>
	
	<delete id="delete" parameterType="int">
		DELETE 
		FROM 
			placeList  
		WHERE 
			placeid = #{placeid};
	</delete>
	
	<select id="chartcount" parameterType="map" resultType="int">
		SELECT 
		   	  count(placeid)
		FROM 
			  placeList
		WHERE 
			  placecategory = #{placecategory} and uuid = #{uuid};
	
	
	</select>
	
	<select id="chartline" parameterType="map" resultType="int">
		SELECT
				count(placeid) 
		FROM 
				placeList 
		WHERE 
				uuid = #{uuid} and (DATE(placeregdate) BETWEEN  #{firstdate} and #{enddate});
	
	
	</select>
	
	<select id="area" parameterType="map" resultType="int">
		SELECT 
				count(*) 
		FROM 
				placeList  
		WHERE 
				placejuso 
		LIKE  
				#{areaname} and uuid =#{uuid};
	</select>
	
	
	<select id="follower" parameterType="int" resultType="com.sm.domain.MypageVO">
	SELECT
			*
	FROM
			follow
	WHERE 
			(uuid=#{uuid} OR follow_uuid=#{uuid});
	</select>
	
	<select id="bmcount" parameterType="int" resultType="com.sm.domain.MypageVO">
	SELECT
			*
	FROM
			bookmark
	WHERE 
			uuid=#{uuid};
	</select>
	
	<select id="membername" parameterType="int" resultType="String">
	SELECT
			membernick
	FROM
			member
	WHERE
			uuid=#{uuid};
	
	</select>
	
	<select id="following" parameterType="int" resultType="com.sm.domain.MypageVO">
	SELECT 
			b.membernick ,b.uuid,mp.p_name
	FROM 
			member b ,member_profile mp
	WHERE	
			 b.uuid = mp.uuid and b.uuid=#{uuid};
	</select>
	
	<select id="status" parameterType="map" resultType="String">
	SELECT 
			status 
	FROM 
			follow 
	WHERE 
			uuid = #{uuid} and follow_uuid =#{follow_uuid};
	</select>
	
	<select id="followingyoucheck" parameterType="int" resultType="int">
		SELECT 
				follow_uuid 
		FROM 
				follow 
		WHERE 
				uuid=#{uuid};
	</select>
	
	<select id="followingmecheck" parameterType="int" resultType="int">
		SELECT 
				uuid
		FROM
				follow 
		WHERE 
				follow_uuid=#{uuid};
	</select>
	<select id="followeryoucheck" parameterType="int" resultType="int">
		SELECT 
				follow_uuid 
		FROM 
				follow 
		WHERE 
				uuid=#{uuid};
	</select>
	
	<select id="followermecheck" parameterType="int" resultType="int">
		SELECT 
				uuid
		FROM
				follow 
		WHERE 
				follow_uuid=#{uuid};
	</select>
	
	<select id="mypagebm" parameterType="int" resultType="int">
	SELECT
			ts_id
	FROM
			bookmark
	WHERE 
			uuid=#{uuid};
	</select>
	
	<select id="mypagetravelstory" parameterType="int" resultType="com.sm.domain.travelmembernickVO">
	SELECT
			ts.tstitle ,ts.tsregdate ,m.membernick 
	FROM
			travel_story ts,member m
	WHERE 
			tsid=#{tsid} and ts.uuid =m.uuid ;
	</select>
	
	<select id="mypagelike" parameterType="int" resultType="com.sm.domain.TravelVO">
	SELECT
			*
	FROM
			travel_story
	WHERE 
			uuid=#{uuid}
	ORDER by tslike DESC ;
	</select>
	
	<insert id="followok" parameterType="map">
	INSERT INTO 
				follow 
	VALUES
				(#{uuid},#{follow_uuid},'Y');
				
	UPDATE 
			follow 
	SET 
			status = 'Y' 
	WHERE 
			uuid=#{follow_uuid} and follow_uuid=#{uuid};
		
	</insert>
	
	 <update id="followdel" parameterType="map">
	UPDATE 
			follow 
	SET 
			status = 'N' 
	where 
			uuid=#{follow_uuid} and follow_uuid=#{uuid};
	
	DELETE FROM 
				follow
	WHERE 
				uuid=#{uuid} and follow_uuid=#{follow_uuid};
	
	</update> 
	

</mapper>